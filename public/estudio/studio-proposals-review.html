<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name=”robots” content=”noindex,nofollow”>
  <meta http-equiv='content-language' content='zh-cn'>

  <link rel="icon" href="https://www.bluvarri.com/favicon.png">
  <title>提案信息 - E-Studio</title>
  <script src="/common/javascripts/avif-webp.min.js"></script>


  <link rel="stylesheet" href="/estudio/stylesheets/studio.scss">
  <link rel="stylesheet" href="/estudio/stylesheets/studio-proposals-review.scss">

</head>

<body>
  <pt-app id="app" v-cloak>
    <!-- header nav -->
    <header class="text-white">
      <div class="header-box">

        <div class="d-flex justify-content-between align-items-center hdlayout">

          <div class="d-flex">
            <a href="/">
              <div class="d-flex align-items-center logo">
                <img src="/common/icon/logo_blv-final-white.png" alt="logo">
  
              </div>
            </a>
  
          </div>
  
          <div>
  
            <div class="btn-group" style="margin-right: 8px;">
  
              <button type="button" class="btn entry-nav" data-bs-toggle="dropdown" aria-expanded="false">
                <div class="tooltip-nav" data-bs-toggle="tooltip" data-bs-custom-class="custom-tooltip"
                  data-bs-trigger="hover" data-bs-placement="bottom" data-bs-title="访达">
                  <i class="bi bi-grid"></i>
                </div>
              </button>
              <ul class="dropdown-menu dropdown-menu-end dropdown-dark">
                <li>
                  <a href="/">
                    <button class="dropdown-item" type="button">
                      <img class="forward-icon me-2" src="/common/icon/logo_blv-final-black.png" alt="blv-logo"> 主站首页
                    </button>
                  </a>
                </li>
                <li>
                  <a href="/rainbow/teixcalaanli">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-rainbow me-2"></i> 彩虹部落
                    </button>
                  </a>
                </li>
                <li>
                  <a href="/mall/gig-economy">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-bag-heart me-2"></i> 心选商店
                    </button>
                  </a>
                </li>
                <li>
                  <a href="/affiliate/dashboard">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-megaphone me-2"></i> 带货中心
                    </button>
                  </a>
                </li>
  
                <li>
                  <a href="/epod/pod-packages-order">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-tags me-2"></i> 奇迹工坊
                    </button>
                  </a>
                </li>
                <li>
                  <a href="/estudio/studio-dashboard">
                    <button class="dropdown-item" type="button" >
                      <i class="bi bi-flower1 me-2"></i> 薪动商号
                     </button>
                  </a>
                </li>
                <li v-if="!!getIdentity().hiLinkUrl">
                  <a :href="getIdentity().hiLinkUrl">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-pin-map me-2"></i> {{getIdentity().hiLinkName}}
                    </button>
                  </a>
                </li>
              </ul>
  
            </div>
  
  
  
            <div class="btn-group private-msg-atom" style="margin-right: 8px;">
              <button type="button" class="btn entry-nav" data-bs-toggle="dropdown" aria-expanded="false">
                <div class="tooltip-nav" data-bs-custom-class="custom-tooltip" data-bs-toggle="tooltip"
                  data-bs-placement="bottom" data-bs-trigger="hover" data-bs-title="消息">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M2.80403 8.3533C2.52389 10.9562 2.53637 13.9582 2.9262 16.5505C3.1419 17.9849 4.31257 19.0845 5.75763 19.2102L7.26787 19.3414C10.4169 19.6152 13.5838 19.6152 16.7328 19.3414L18.2431 19.2102C19.6881 19.0845 20.8588 17.9849 21.0745 16.5505C21.4643 13.9582 21.4768 10.9564 21.1967 8.35345C21.1605 8.05169 21.1197 7.75034 21.0745 7.44949C20.8588 6.0151 19.6881 4.91545 18.2431 4.78983L16.7328 4.65855C13.5838 4.38481 10.4169 4.38481 7.26787 4.65855L5.75763 4.78983C4.31257 4.91545 3.1419 6.0151 2.9262 7.44949C2.88096 7.75028 2.84024 8.05159 2.80403 8.3533ZM7.39777 6.15292C10.4604 5.88669 13.5403 5.88669 16.6029 6.15292L18.1131 6.2842C18.8675 6.34977 19.4786 6.92379 19.5912 7.67254C19.6029 7.7503 19.6142 7.82809 19.6253 7.90592L14.0643 10.9954C12.7807 11.7085 11.2199 11.7085 9.93632 10.9954L4.37539 7.90596C4.38645 7.82812 4.39783 7.75031 4.40952 7.67254C4.52211 6.92379 5.13321 6.34977 5.88754 6.2842L7.39777 6.15292ZM19.8088 9.51989C20.0028 11.7876 19.9303 14.0725 19.5912 16.3274C19.4786 17.0762 18.8675 17.6502 18.1132 17.7158L16.6029 17.8471C13.5403 18.1133 10.4604 18.1133 7.39777 17.8471L5.88754 17.7158C5.13321 17.6502 4.52211 17.0762 4.40952 16.3274C4.07043 14.0725 3.99787 11.7877 4.19184 9.51992L9.20786 12.3066C10.9445 13.2714 13.0561 13.2714 14.7928 12.3066L19.8088 9.51989Z"
                      fill="white" />
                  </svg>
                </div>
              </button>
              <ul class="dropdown-menu dropdown-menu-end">
                <div class="friend-header">
                  私信（{{friends.totalUnRead}}）
                </div>
                <div class="friend-list">
  
                  <li class="friend-item" v-for="friend in friends.records">
                    <a target="_blank" :href="'/messages/'+ friend.id">
                      <div class="friend-container">
                        <div class="frend-avatar-container">
                          <img class="frend-avatar" :src="adaptiveImageUriV(friend.avatar) || defaultAvatarImage"
                            @error.once="e => { e.target.src = defaultAvatarImage }">
                          <div v-if="friend.brandMark=='3'" class="online-indicator">
                            <div class="online-indicator-content">
                            </div>
                          </div>
                        </div>
                        <div class="friend-info">
                          <div class="friend-name"><span class="ellipsis-1">{{friend.title}}</span> </div>
                          <div class="friend-msg"> <span class="ellipsis-1">{{friend.latestContent}}</span> </div>
                          <div class="msg-time">{{getPublishTimeV(friend.modifiedAt)}}</div>
                        </div>
                      </div>
                    </a>
                  </li>
  
  
  
                </div>
  
  
  
              </ul>
            </div>
  
            <div class="btn-group">
              <button type="button" class="btn btn-secondary dropdown-toggle button_user_vue brand-avatar"
                data-bs-toggle="dropdown" aria-expanded="false">
                <img :src="adaptiveImageUriV(getIdentity().avatar)  || defaultAvatarImage"
                  @error.once="e => { e.target.src = defaultAvatarImage }">
              </button>
              <ul class="dropdown-menu dropdown-menu-end dropdown-dark">
                <li>
                  <a href="/estudio/studio-setting-profile">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-person-vcard me-2"></i> 品牌形象
                    </button>
                  </a>
                </li>
                <li>
                  <button @click="logout()" class="dropdown-item" type="button">
                    <i class="bi bi-box-arrow-right me-2"></i> 退出登录
                  </button>
                </li>
                <li>
                  <a href="/mall/delete-account">
                    <button class="dropdown-item" type="button">
                      <i class="bi bi-trash3 me-2"></i> 删除账号
                    </button>
                  </a>
                </li>
  
                <li>
                  <button class="dropdown-item" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#feedback_offcanvas_right" aria-controls="feedback_offcanvas_right">
                    <i class="bi bi-flag me-2"></i> 问题反馈
                  </button>
                </li>
              </ul>
            </div>
  
  
          </div>
  
  
        </div>

      </div>
    </header>
    <content>
      
      <main>
        <div class="content-box">
          <!-- Page Header -->
          <div class="page-header">
            <h1><i class="bi bi-file-earmark-text me-2"></i>提案详情</h1>
            <div class="subtitle">提案条款、服务费用和相关材料信息</div>
          </div>
          <section class="section-general-block section-box box-bg-primary mb-4">
            <div class="section-header">
              <span class="header-title">基础信息</span>
            </div>
            <div class="info-block">
              <div class="row  mb-3">
                <label for="inputProject" class="col-sm-2 col-form-label"><i class="bi bi-bookmark me-2"></i>项目名称</label>
                <div class="col-sm-10">
                  <input :value="proposal.projectName" name="inputProject" type="text" class="inputDefault" disabled>
                </div>
              </div>
              <div class="row  mb-3 mt-3">
                <label for="inputStarts" class="col-sm-2 col-form-label"><i class="bi bi-calendar-event me-2"></i>开始时间</label>
                <div class="col-sm-10">
                  <input :value="proposal.projectStarts"  name="inputStarts" type="text" class="inputDefault" disabled>
                </div>
              </div>
              <div class="row  mb-3 mt-3">
                <label for="inputEnds" class="col-sm-2 col-form-label"><i class="bi bi-calendar-check me-2"></i>结束时间</label>
                <div class="col-sm-10">
                  <input :value="proposal.projectEnds"  name="inputEnds" type="text" class="inputDefault" disabled>
                </div>
              </div>
              <div class="row  mb-3 mt-3">
                <label for="inputStatus" class="col-sm-2 col-form-label"><i class="bi bi-flag me-2"></i>提案状态</label>
                <div class="col-sm-10">
                  <span class="status-badge" :class="getStatusBadgeClassV(proposal.projectStatus)">
                    <i class="bi bi-circle-fill"></i>
                    {{explainProposalProjectStatusV(proposal.projectStatus)}}
                  </span>
                </div>
              </div>
            </div>
          </section>
          <section class="section-service-block section-box box-bg-primary mb-5">
            <div class="section-header">服务与费用</div>
            <div class="info-block">
              <div class="table-responsive">

                <table class="table table-sm table-hover table-dark">
                  <thead>
                    <th>服务</th>
                    <th class="w-10">数量</th>
                    <th class="w-15">单价</th>
                    <th class="w-20">金额</th>
                  </thead>
                  <tbody>
                    <tr v-for="item in proposal.services">
                      <td :title="item.serviceName">
                        <span class="ellipsis-1">
                          {{item.serviceName}}
                        </span>
                      </td>
                      <td :title="item.quantity">{{item.quantity}}</td>
                      <td :title="item.price">{{item.price}}</td>
                      <td :title="(item.quantity * item.price).toFixed(2)">{{(item.quantity * item.price).toFixed(2)}}</td>
                    </tr>
                    <tr class="table-hi">
                      <td colspan="4">合计:<span class="ms-1 me-1">¥{{proposal.total}}</span></td>
                    </tr>
                  </tbody>
                </table>

              </div>
              
            </div>
          </section>
         
          <section class="section-extra-block section-box box-bg-primary mb-5">
            <div class="section-header">条款或其他</div>
            <div  class="info-block">
               <div class="ql-editor" v-html="proposal.extraContent">

               </div>
            </div>
          </section>
  
          <section class="section-material-block section-box box-bg-primary mb-5">
            <div class="section-header d-flex justify-content-between">
              <div>交付材料</div>
              <button :class="{'disabled': getIdentity().brandId!=proposal.sellerBrandId,'loading': btn_ctl.deliver_material_uploading}"  class="btn btn-file-upload bgPrimary">
                
                <div class="btn-file-upload-wrp">上传 <input @change="uploadProposalMaterialV($event,'deliver')" class="file-input" type="file"  style="opacity: 0; cursor: pointer; width: 100%; height: 100%; font-size: 0px; position: absolute; top: 0px; left: 0px;"></div>
                <div class="loading-content">
                  <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                  <span role="status">正在上传...</span>
                </div>
              </button>
            </div>
            <div class="info-block">

              <div v-if="deliverMaterialList.length === 0" class="material-empty">
                <i class="bi bi-folder2-open d-block"></i>
                <span>暂无交付材料</span>
              </div>

              <div v-for="item in deliverMaterialList" class="material-item">
                <div class="file-icon">
                  <i class="bi bi-file-earmark"></i>
                </div>
                <span :title="item.materialName" class="file-name ellipsis-1">{{item.materialName}}</span>
                <div class="material-actions">
                  <div class="d-flex align-items-center">

                    <span>
                      <a target="_blank" class="download" :download="item.materialName" :href="item.materialUrl"><i class="bi bi-cloud-arrow-down"></i></a>
                    </span>
                    <span  v-if="getIdentity().brandId==proposal.sellerBrandId"  class="option-edit ms-2">
                      <div class="dropdown">
                        <a class="btn-option-secondary dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="bi bi-three-dots"></i>
                        </a>
                      
                        <ul class="dropdown-menu">
                          <li  v-preventreclick  @click="showMaterialRenameModalV(item.id,'deliver')" ><a class="dropdown-item">重命名文件</a></li>
                          <li v-preventreclick  @click="delOneMaterialV(item.id,'deliver')" ><a class="dropdown-item">删除材料</a></li>
                        </ul>
                      </div>
                    </span>

                  </div>
                </div>
              </div>


            </div>
          </section>
  
          
  
          <section class="section-material-block section-box box-bg-primary mb-5">
            <div class="section-header d-flex justify-content-between">
              <div>商家材料</div>
              <button :class="{'disabled': getIdentity().brandId!=proposal.sellerBrandId,'loading': btn_ctl.seller_material_uploading}"  class="btn btn-file-upload bgPrimary">
                
                <div class="btn-file-upload-wrp">上传 <input @change="uploadProposalMaterialV($event,'seller')" class="file-input" type="file"  style="opacity: 0; cursor: pointer; width: 100%; height: 100%; font-size: 0px; position: absolute; top: 0px; left: 0px;"></div>
                <div class="loading-content">
                  <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                  <span role="status">正在上传...</span>
                </div>

              </button>
            </div>
            <div class="info-block">

              <div v-if="sellerMaterialList.length === 0" class="material-empty">
                <i class="bi bi-folder2-open d-block"></i>
                <span>暂无商家材料</span>
              </div>

              <div v-for="item in sellerMaterialList" class="material-item">
                <div class="file-icon">
                  <i class="bi bi-file-earmark"></i>
                </div>
                <span :title="item.materialName" class="file-name ellipsis-1">{{item.materialName}}</span>
                <div class="material-actions">
                  <div class="d-flex align-items-center">

                    <span>
                      <a target="_blank" class="download" :download="item.materialName" :href="item.materialUrl"><i class="bi bi-cloud-arrow-down"></i></a>
                    </span>
                    <span  v-if="getIdentity().brandId==proposal.sellerBrandId"  class="option-edit ms-2">
                      <div class="dropdown">
                        <a class="btn-option-secondary dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="bi bi-three-dots"></i>
                        </a>
                      
                        <ul class="dropdown-menu">
                          <li  v-preventreclick  @click="showMaterialRenameModalV(item.id,'seller')" ><a class="dropdown-item">重命名文件</a></li>
                          <li v-preventreclick  @click="delOneMaterialV(item.id,'seller')" ><a class="dropdown-item">删除材料</a></li>
                        </ul>
                      </div>
                    </span>

                  </div>
                </div>
              </div>

            </div>
          </section>
  
          <section class="section-material-block section-box box-bg-primary mb-5">
            <div class="section-header d-flex justify-content-between">
              <div>买家材料</div>
              <button :class="{'disabled': getIdentity().brandId!=proposal.buyerBrandId,'loading': btn_ctl.buyer_material_uploading}"  class="btn btn-file-upload bgPrimary">
                
                <div class="btn-file-upload-wrp">上传 <input @change="uploadProposalMaterialV($event,'buyer')"  class="file-input" type="file"  style="opacity: 0; cursor: pointer; width: 100%; height: 100%; font-size: 0px; position: absolute; top: 0px; left: 0px;"></div>
                <div class="loading-content">
                  <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                  <span role="status">正在上传...</span>
                </div>
              </button>
            </div>
            <div class="info-block">

              <div v-if="buyerMaterialList.length === 0" class="material-empty">
                <i class="bi bi-folder2-open d-block"></i>
                <span>暂无买家材料</span>
              </div>

              <div v-for="item in buyerMaterialList" class="material-item">
                <div class="file-icon">
                  <i class="bi bi-file-earmark"></i>
                </div>
                <span :title="item.materialName" class="file-name ellipsis-1">{{item.materialName}}</span>
                <div class="material-actions">
                  <div class="d-flex align-items-center">

                    <span>
                      <a target="_blank" class="download" :download="item.materialName" :href="item.materialUrl"><i class="bi bi-cloud-arrow-down"></i></a>
                    </span>
                    <span  v-if="getIdentity().brandId==proposal.buyerBrandId"  class="option-edit ms-2">
                      <div class="dropdown">
                        <a class="btn-option-secondary dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="bi bi-three-dots"></i>
                        </a>
                      
                        <ul class="dropdown-menu">
                          <li  v-preventreclick  @click="showMaterialRenameModalV(item.id,'buyer')" ><a class="dropdown-item">重命名文件</a></li>
                          <li v-preventreclick  @click="delOneMaterialV(item.id,'buyer')" ><a class="dropdown-item">删除材料</a></li>
                        </ul>
                      </div>
                    </span>

                  </div>
                </div>
              </div>

            </div>


          </section>

          <section class="section-terms-block section-box box-bg-primary mb-4">
            <div class="section-header">
              <span class="header-title">提案须知</span>
            </div>
            <div class="info-block">
              <ul class="terms-list">
                <li>
                  <span class="term-number">1</span>
                  <span>提案采用分步交付设计，每一项服务对应一条账单，建议买家在商家交付相应服务后再到【奇迹工坊】-【账单管理】进行付款。</span>
                </li>
                <li>
                  <span class="term-number">2</span>
                  <span>买家已签约的提案被收录到【奇迹工坊】-【履约中心】-【提案】，可根据需要随时查看提案进度。</span>
                </li>
                <li>
                  <span class="term-number">3</span>
                  <span>完成相应服务后，商家可前往【薪动商号】-【账单管理】，通过「发起付款」发送账单给买家。</span>
                </li>
              </ul>
            </div>
          </section>

          <div v-if="proposal.projectStatus=='0'" class="proposal-cta-box d-flex justify-content-center align-items-center">
            <button  :class="{'disabled': !(getIdentity().brandId!=proposal.sellerBrandId)}"  v-preventreclick  @click="showSignFocusModalV" class="btn btn-save bgPrimaryBlue">
              <i class="bi bi-pen me-2"></i>签约提案
            </button>
          </div>

        </div>

        <div class="empty-box"></div>

        
      </main>
      <section class="modals">
        <!-- focus modal -->
        <div class="modal-container">
          <div class="modal fade" id="focusModal" data-bs-backdrop="static" tabindex="-1">
            <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
              <div class="modal-content">
                <div class="modal-header d-flex justify-content-center border-0 display-dialog-header-bg">
                  <h1 class="modal-title fs-5">操作提示</h1>
                </div>
                <div class="modal-body d-flex justify-content-center border-0 display-dialog-body-bg">
                  <div class="product-feature">
                    <p class="card-text">{{focusModal.message}}</p>
                  </div>
                </div>
                <div class="modal-footer btn-light d-flex justify-content-between border-0 display-dialog-footer-bg">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                  <button v-preventreclick @click="focusModal.confirmHandler"  type="button"  class="btn btn-primary">继续</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- rename material  modal -->
       <div class="modal-container">
        <div class="modal fade" id="renameMaterialModal" data-bs-backdrop="static" tabindex="-1">
          <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header  display-dialog-header-bg">
                <h1 class="modal-title fs-5">编辑材料</h1>
                <button type="button"  class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body d-flex justify-content-center border-0 display-dialog-body-bg">

                <form class="w-100" onsubmit="return false">
  

                
                  <div class="mt-3">
                    <label for="renameMaterial" class="form-label">文件名</label>
                    <input v-model="materialFileOptions.materialName" name="renameMaterial" maxlength="100" autocomplete="off" type="text" class="form-control">

                  </div> 


                  
                  <button 
                  :class="{'disabled': !materialFileOptions.materialName, 
                  'btn-primary': !!materialFileOptions.materialName,
                  'btn-secondary': !materialFileOptions.materialName}"
                    v-preventreclick @click="renameMaterialV" 
                  type="submit"  class="btn  mt-5 w-100">提交</button>

                  
                </form>
                
              </div>
            </div>
          </div>
        </div>
      </div>

      </section>

    </content>
  </pt-app>
  <section class="feedback_offcanvas" id="section_feedback_offcanvas">

    <div class="offcanvas offcanvas-end" tabindex="-1" id="feedback_offcanvas_right"
      aria-labelledby="feedbackOffcanvasRightLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="feedbackOffcanvasRightLabel">发送反馈到小蔚</h5>
        <button id="closeFeedbackOffcanvas" type="button" class="btn-close" data-bs-dismiss="offcanvas"
          aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <form id="feedback-form">
          <div class="mt-3">
            <label for="input_issue" class="form-label">您遇到的具体问题是什么(必填,300字以内)</label>
            <textarea rows="8" type="text" maxlength="300" class="form-control" id="input_issue"></textarea>
          </div>
          <div class="mt-3">
            <label class="form-label">附件图片(选填)</label>
            <div class="feedback-attachment-upload-container dropzone-wrapper">
              <img id="lastestFeedbackAttachment">
              <div class="dropzone-desc">
                <i class="bi bi-cloud-plus"></i>
              </div>
              <input type="file" id="input_issue_attachment" accept="image/jpg, image/png, image/jpeg" class="dropzone">
            </div>
          </div>
          <div class="mt-3">
            <label for="input_issue_contact" class="form-label">您的联系方式(选填)</label>
            <input id="input_issue_contact" min="1" max="50000" step="1" type="text" class="form-control"
              placeholder="请留下邮箱或电话，使我们快速反馈">
          </div>
          <button type="submit" class="btn btn-primary mt-5 w-100">提交</button>
        </form>
      </div>
    </div>

  </section>
  <script type="module" src="/common/javascripts/feedback.js"></script>
  <script type="module" src="/common/javascripts/tm.js"></script>
  <script type="module" src="/estudio/javascripts/studio-proposals-review.js"></script>

</body>

</html>