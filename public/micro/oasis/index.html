<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name=”robots” content=”noindex,nofollow”>
    <meta http-equiv ='content-language' content ='zh-cn'>

<link rel="icon" href="/favicon.png">
    <title>基地</title>
    <script src="/common/javascripts/avif-webp.min.js"></script>


    <link rel="stylesheet" href="/common/stylesheets/style.scss">

    <link rel="stylesheet" href="/micro/stylesheets/teixcalaanli.scss">
    <link rel="stylesheet" href="/micro/arch/stylesheets/teixcalaanli-arch.scss">

    <link rel="stylesheet" href="/micro/stylesheets/oasis.scss">

</head>
<body>
  <micro-app id="app" v-cloak>
    <main class="d-flex flex-row">
      <div class="offcanvas-xxl offcanvas-start" tabindex="-1" id="mcSidebar" aria-labelledby="mcSidebarOffcanvasLabel">
        <div class="sidebarContainer d-flex flex-row">
          <col-nav-main>
          <div class="nav-container-wrapper">
            <a href="/micro/teixcalaanli" data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="少数派"> 
              <div class="nav-item-default nav-teixcalaanli d-flex align-items-center justify-content-center ms-3">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6 13C3.8 13 2 14.8 2 17C2 19.2 3.8 21 6 21C8.2 21 10 19.2 10 17C10 14.8 8.2 13 6 13ZM12 3C9.8 3 8 4.8 8 7C8 9.2 9.8 11 12 11C14.2 11 16 9.2 16 7C16 4.8 14.2 3 12 3ZM18 13C15.8 13 14 14.8 14 17C14 19.2 15.8 21 18 21C20.2 21 22 19.2 22 17C22 14.8 20.2 13 18 13Z" fill="#36F7E5"/>
                  </svg>
              </div>
            </a>
            <a href="/micro/arch/channel-0002" data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="私信"> 
              <div class="nav-private nav-item-default  d-flex align-items-center justify-content-center   ms-3 mt-2">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8.99991 11.9999H14.9999" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                  <path d="M9 18H8C4.68629 18 2 15.3137 2 12C2 8.68629 4.68629 6 8 6H9" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                  <path d="M15 6H16C19.3137 6 22 8.68629 22 12C22 15.3137 19.3137 18 16 18H15" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                  </svg>              
              </div>
            </a>
            <a v-for="oasis in joinedoases.records"  :href="'/micro/oasis?oasis_id='+oasis.id" data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" :data-bs-content="oasis.title">
              <div class="nav-item-default  d-flex align-items-center justify-content-center   ms-3 mt-2"
                   :class="{'active': oasis.id==oasisId}">
                <div class="oasis-avatar-wrapper">
                  <img class="oasis-avatar-tiny" 
                :src="adaptiveImageUriV(oasis.avatar) || oasisAvatarDefault" @error.once="e => { e.target.src = oasisAvatarDefault }">  
                </div>
              </div>
            </a>

          </div>
          
          <div class="nav-setting">
            <div class="nav-item-default nav-gear d-flex align-items-center justify-content-center ms-3">
              <div class="btn-group">
                <button type="button" class="btn btn-secondary dropdown-toggle button_user_vue brand-avatar" data-bs-toggle="dropdown" aria-expanded="false">
                  <img  :src="adaptiveImageUriV(getIdentity().avatar)  || defaultAvatarImage" @error.once="e => { e.target.src = defaultAvatarImage }">
                </button>
                <ul class="dropdown-menu dropdown-menu-end ms-5">
                  <li>
                    <a href="/estudio/studio-setting-profile">
                      <button class="dropdown-item" type="button">
                        <i class="bi bi-person-vcard me-1"></i> 品牌形象
                       </button>
                    </a>
                  </li>
                  <li>
                      <button @click="logout()" class="dropdown-item" type="button">   
                        <i class="bi bi-box-arrow-right me-1"></i> 注销 
                      </button>
                  </li>
                  <li>
                    <a href="/mall/delete-account">
                      <button class="dropdown-item" type="button">
                        <i class="bi bi-trash3 me-1"></i> 删除账号
                       </button>
                    </a>
                  </li>
                  
                  <li>
                    <button class="dropdown-item" type="button" data-bs-toggle="offcanvas" data-bs-target="#feedback_offcanvas_right" aria-controls="feedback_offcanvas_right">
                      <i class="bi bi-flag me-1"></i> 反馈
                    </button>
                  </li>
                </ul>
              </div>
    
            </div>
          </div>
        </col-nav-main>
        <col-nav-sub>
        <div class="nav-title ms-3 mt-3">
          <h3>{{announce.title}}</h3>
        </div>
        <div class="nav-sub-container mt-3">
          <div>
    
            <a  class="nav-link nav-sub-link-active p-2 ms-3 d-flex flex-row align-items-center">
              <i class="bi bi-house"></i>
                
          
              <span>主页</span>  
            </a>
            <a class="nav-link  nva-link-default p-2 ms-3  d-flex flex-row align-items-center" :href="'/micro/arch/channel-0001?oasis_id='+ oasisId">
              <i class="bi bi-fan"></i>
              <span class="link-title">Fan</span>  
            </a>

            <a  v-for="channel in channelSort"   class="nav-link  nva-link-default p-2 ms-3  d-flex flex-row align-items-center" :href="'/micro/oasis/mini?och='+getChannelDataV(channel,oaisiChannelList).oasisChannelId + '&oasis_id=' + oasisId">
              <i class="bi bi-filetype-html"></i>
                
              <span class="link-title">{{getChannelDataV(channel,oaisiChannelList).channelName}}</span>  
            </a>
           
            
            
            
          </div>
          
          
        </div>
        </col-nav-sub>
        </div>
      </div>
      <col-content>
      <div class="hero-container">
          <div class="hero-info d-flex flex-row align-items-baseline">
              <div>
                <img class="oasis-avatar" :src="adaptiveImageUriV(announce.avatar) || oasisAvatarDefault" @error.once="e => { e.target.src = oasisAvatarDefault }">
              </div>
             <div class="ms-4">
              <h2>{{announce.title}}</h2>
              <p class="help-text">{{announce.subTitle}}</p>
             </div>
          </div>
      </div>
      <div class="nav-oasis-container d-flex justify-content-between">
        <ul class="nav border-0 h-100">
          <li class="nav-item active" role="presentation">
            <a class="nav-link d-flex align-items-center" aria-current="page" :href="'/micro/oasis?oasis_id='+oasisId">宣传</a>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link d-flex align-items-center" aria-current="page" :href="'/micro/oasis/commission?oasis_id='+oasisId">委托</a>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link d-flex align-items-center" aria-current="page" :href="'/micro/oasis/transparent?oasis_id='+oasisId">透视</a>
          </li>
          <li class="nav-item" role="presentation">
            <!-- <a class="nav-link d-flex align-items-center" aria-current="page">
              <i class="bi bi-three-dots"></i>
            </a> -->
            <div class="dropdown nav-link d-flex align-items-center">
              <a class="btn btn-secondary dropdown-toggle btn-oasis-option" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-three-dots"></i>
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item">
                  <button type="button" class="btn  oasis-option" data-bs-toggle="modal" data-bs-target="#topUpToOasisModal">
                    赞助
                  </button>
                  </a>
                </li>
                <li><a class="dropdown-item">
                  <button type="button" class="btn  oasis-option" data-bs-toggle="modal" data-bs-target="#collectAccountModal">
                    收账
                  </button>
                  </a>
              </li>
              <li v-if="!inOasisV()"><a  class="dropdown-item">
                <button @click="followOasisV"  v-preventreclick  type="button" class="btn  oasis-option">
                  加入基地
                </button>
                </a>
              </li>
              <li v-if="inOasisV()&&!initiatorRoleV()">
                <a  class="dropdown-item">
                  <button @click="unfollowOasisV"  v-preventreclick  type="button" class="btn oasis-option" >
                    退出基地
                  </button>
                </a>
              </li>
              <li v-if="initiatorRoleV()">
                <a  class="dropdown-item" :href="'/micro/create-oasis?option=edit&&oasis_id='+oasisId">
                  <button type="button" class="btn  oasis-option">
                    基地设置
                  </button>
                </a>
              </li>
              <li v-if="initiatorRoleV()">
                <a  class="dropdown-item" :href="'/micro/oasis/mini-assistant?oasis_id='+oasisId">
                  <button type="button" class="btn oasis-option">
                    频道助手
                  </button>
                </a>
              </li>
              </ul>
            </div>
          </li>
        </ul>
        <div class="toggle-nav me-3 ">
          <div class="d-flex align-items-center h-100 " >
            <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#mcSidebar" aria-controls="bdSidebar" aria-label="Toggle mcSidebar navigation">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="bi" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
      <div class="oasis-announce-body ms-3 me-3">
        <div class="nav-announce-wrapper">
          <nav id="nav-announce" class="navbar navbar-dark  mt-5">
            <div class="navbar-wrapper">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="#oasis_announce">宣言</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#oasis_risk">风险</a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <div class="info-container me-5 mt-2" data-bs-spy="scroll" data-bs-target="#nav-announce" data-bs-offset="50">
        
          
          <div id="section1">
            <div id="oasis_announce" class="pb-4">
              <h3>宣言</h3>
            </div>
            <div class="template asset" contenteditable="false" data-alt-text="" data-caption="" data-id="39875611">
              <figure v-if="announce.announceUrl">
                <img class="announceContent" alt="" class="fit" :src="adaptiveImageUriV(announce.announceUrl)" >
              </figure>
              <p v-else>未设置宣言</p>
            </div>
          </div>
          
          <div id="section2">
            <div id="oasis_risk" class="py-4">
              <h3>风险与挑战</h3>
            </div>
            <p class="text-preline risk-info">{{ announce.risk}}</p>
  
          </div>
          <div id="section3" class="spacer">
          </div>
      </div>
      </div>
      </col-content>
    </main>
    
   
    <section class="modals">
      <div class="modal-container">
              
        <!-- Modal -->
        <div class="modal fade" id="topUpToOasisModal" data-bs-backdrop="static" tabindex="-1">
          <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content text-color-dark">
              <div class="modal-header">
                <h1 class="modal-title fs-5">赞助基地</h1>
                <button type="button" id="closeTopUpToOasisModal" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body d-flex justify-content-center">
                <form>
                  <div class="mt-3">
                    <label for="t1" class="form-label">可赞助金额</label>
                    <input :value="brandAccount.drawable" type="text" maxlength="255" class="form-control" disabled id="t1">
                  </div> 
                  <div class="mt-3">
                    <label for="t2" class="form-label">基地余额</label>
                    <input id="t2" :value="oasisAccount.drawable" type="text" maxlength="255" class="form-control" disabled>
                  </div> 
                  <div class="mt-3">
                    <label for="t3" class="form-label">赞助金额</label>
                    <input id="t3" v-model="amount"  @input="transformInputNumberV($event)" min="1" max="50000" step="1" type="number" class="form-control">
                  </div> 
                </form>
                
              </div>
              <div class="modal-footer btn-light">
                <button  v-preventreclick 
                :class="{'disabled': !amount || (brandAccount.drawable < amount) , 
                'btn-primary': !!amount || (brandAccount.drawable >= amount) ,
                'btn-secondary': !amount || (brandAccount.drawable < amount)  }"
                @click="topUptoOasisV" type="button"  class="btn btn-primary">赞助</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-container">
              
        <!-- Modal -->
        <div class="modal fade" id="collectAccountModal" data-bs-backdrop="static" tabindex="-1">
          <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content text-color-dark">
              <div class="modal-header">
                <h1 class="modal-title fs-5">收账</h1>
                <button type="button" id="closeCollectAccountModal" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body d-flex justify-content-center">
                <form>
                  <div class="mt-3">
                    <label for="t1" class="form-label">基地余额</label>
                    <input :value="oasisAccount.drawable" type="text" maxlength="255" class="form-control" disabled id="t1">
                  </div> 
                  <div class="mt-3">
                    <label for="t2" class="form-label">累计贡献</label>
                    <input id="t2" :value="point" type="text" maxlength="255" class="form-control" disabled>
                  </div> 
                  <div class="mt-3">
                    <label for="t3" class="form-label">收账金额</label>
                    <input id="t3" @input="transformInputNumberV($event)" min="1" max="50000" step="1" v-model="collectAccountAmount" type="number" class="form-control">
                  </div> 
                  <div class="help-text fs-6 ms-1 mt-1">
                    <i class="bi bi-question-circle"></i><span class="ms-1">规则：每日只能收账一次,收账金额最大为基地余额的10%</span>
                  </div>
                </form>
                
              </div>
              <div class="modal-footer btn-light">
                <button   v-preventreclick 
                :class="{'disabled': !collectAccountAmount || (oasisAccount.drawable < 10*collectAccountAmount ) || (point <  collectAccountAmount ) , 
                'btn-primary': !!amount && (oasisAccount.drawable >= 10*collectAccountAmount ) && (point >=collectAccountAmount ) ,
                'btn-secondary': !collectAccountAmount || (oasisAccount.drawable < 10*collectAccountAmount ) || (point < collectAccountAmount )  }"
                @click="collectAccountV" type="button"  class="btn btn-primary">收账</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </micro-app>
  <section class="feedback_offcanvas" id="section_feedback_offcanvas">

    <div class="offcanvas offcanvas-end" tabindex="-1" id="feedback_offcanvas_right" aria-labelledby="feedbackOffcanvasRightLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="feedbackOffcanvasRightLabel">发送反馈到Bluvarri</h5>
        <button id="closeFeedbackOffcanvas" type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <form id="feedback-form">
          <div class="mt-3">
            <label for="input_issue" class="form-label">您遇到的具体问题是什么(必填,300字以内)</label>
            <textarea  rows="8" type="text" maxlength="300" class="form-control"  id="input_issue"></textarea>
          </div> 
          <div class="mt-3">
            <label class="form-label">附件图片(选填)</label>
            <div class="feedback-attachment-upload-container dropzone-wrapper">
              <img  id="lastestFeedbackAttachment" >
              <div class="dropzone-desc">
                <i class="bi bi-cloud-plus"></i>
              </div>
              <input type="file" id="input_issue_attachment"  accept="image/jpg, image/png, image/jpeg" class="dropzone">
            </div>
          </div>  
          <div class="mt-3">
            <label for="input_issue_contact" class="form-label">您的联系方式(选填)</label>
            <input id="input_issue_contact"  min="1" max="50000" step="1" type="text" class="form-control" placeholder="请留下邮箱或电话，使我们快速反馈">
          </div> 
          <button type="submit" class="btn btn-primary mt-5 w-100">提交</button>
        </form>
      </div>
    </div>

  </section>
  <script type="module" src="/common/javascripts/feedback.js"></script>
  <script type="module" src="/common/javascripts/tm.js"></script>
  <script type="module" src="/micro/javascripts/oasis.js"></script>


</body>
</html>