<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name=”robots” content=”noindex,nofollow”>
    <meta http-equiv ='content-language' content ='zh-cn'>

    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon">
    <title>基地委托</title>
    <script src="/common/javascripts/avif-webp.min.js"></script>


    <link rel="stylesheet" href="/common/stylesheets/style.scss">
    <link rel="stylesheet" href="/micro/stylesheets/teixcalaanli.scss">
    <link rel="stylesheet" href="/micro/stylesheets/oasis.scss">
    <link rel="stylesheet" href="/micro/arch/stylesheets/teixcalaanli-arch.scss">
    <link rel="stylesheet" href="/micro/stylesheets/commission.scss">



</head>
<body>
  <micro-app id="app">
    <main class="d-flex flex-row">
      <div class="offcanvas-xxl offcanvas-start" tabindex="-1" id="mcSidebar" aria-labelledby="mcSidebarOffcanvasLabel">
        <div class="sidebarContainer d-flex flex-row">
          <col-nav-main>
          <div class="nav-container-wrapper">
            <a href="/micro/teixcalaanli.html" data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="贤者时间"> 
              <div class="nav-item-default nav-teixcalaanli d-flex align-items-center justify-content-center ms-3">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6 13C3.8 13 2 14.8 2 17C2 19.2 3.8 21 6 21C8.2 21 10 19.2 10 17C10 14.8 8.2 13 6 13ZM12 3C9.8 3 8 4.8 8 7C8 9.2 9.8 11 12 11C14.2 11 16 9.2 16 7C16 4.8 14.2 3 12 3ZM18 13C15.8 13 14 14.8 14 17C14 19.2 15.8 21 18 21C20.2 21 22 19.2 22 17C22 14.8 20.2 13 18 13Z" fill="#36F7E5"/>
                  </svg>
              </div>
            </a>
            <a href="/micro/arch/channel-0002.html" data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="私信"> 
              <div class="nav-private nav-item-default  d-flex align-items-center justify-content-center   ms-3 mt-2">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8.99991 11.9999H14.9999" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                  <path d="M9 18H8C4.68629 18 2 15.3137 2 12C2 8.68629 4.68629 6 8 6H9" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                  <path d="M15 6H16C19.3137 6 22 8.68629 22 12C22 15.3137 19.3137 18 16 18H15" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                  </svg>              
              </div>
            </a>
            <a v-for="oasis in joinedoases.records"  :href="'/micro/oasis.html?oasis_id='+oasis.id" data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" :data-bs-content="oasis.title">
              <div class="nav-item-default  d-flex align-items-center justify-content-center   ms-3 mt-2"
                   :class="{'active': oasis.id==oasisId}">
                <div class="oasis-avatar-wrapper">
                  <img class="oasis-avatar-tiny" 
                :src="adaptiveImageUriV(oasis.avatar) || oasisAvatarDefault" @error.once="e => { e.target.src = oasisAvatarDefault }">  
                </div>
              </div>
            </a>

          </div>
          
          <div class="nav-setting">
            <div class="nav-item-default nav-gear d-flex align-items-center justify-content-center ms-3">
              <div class="btn-group">
                <button type="button" class="btn btn-secondary dropdown-toggle button_user_vue" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="bi bi-person-circle"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end ms-5">
                  <li>
                    <a href="/estudio/studio-setting-profile.html">
                      <button class="dropdown-item" type="button">
                        <i class="bi bi-person-vcard me-1"></i> 品牌形象
                       </button>
                    </a>
                  </li>
                  <li>
                      <button onclick="logout()" class="dropdown-item" type="button">   
                        <i class="bi bi-box-arrow-right me-1"></i> 注销 
                      </button>
                  </li>
                  <li>
                    <a href="/mall/delete-account.html">
                      <button class="dropdown-item" type="button">
                        <i class="bi bi-trash3 me-1"></i> 删除账号
                       </button>
                    </a>
                  </li>
                  
                  <li>
                    <button class="dropdown-item" type="button" data-bs-toggle="offcanvas" data-bs-target="#feedback_offcanvas_right" aria-controls="feedback_offcanvas_right">
                      <i class="bi bi-flag me-1"></i> 反馈
                    </button>
                  </li>
                </ul>
              </div>
    
            </div>
          </div>
    </col-nav-main>
    <col-nav-sub>
      <div class="nav-title ms-3 mt-3">
        <h3>{{announce.title}}基地</h3>
      </div>
      <div class="nav-sub-container mt-3">
        <div>
          <a  class="nav-link nav-sub-link-active p-2 ms-3 d-flex flex-row align-items-center">
            <i class="bi bi-house"></i>
              
        
            <span>主页</span>  
          </a>
          <a class="nav-link  nva-link-default p-2 ms-3  d-flex flex-row align-items-center" :href="'/micro/arch/channel-0001.html?oasis_id='+ oasisId">
            <i class="bi bi-fan"></i>
            <span class="link-title">Fan</span>  
          </a>

        
        </div>
        
        
      </div>
    </col-nav-sub>

        </div>
      </div>
      <col-content>
      <div class="hero-container">
        <div class="hero-info d-flex flex-row align-items-baseline">
            <div>
              <img class="oasis-avatar" :src="adaptiveImageUriV(announce.avatar) || oasisAvatarDefault" @error.once="e => { e.target.src = oasisAvatarDefault }">
            </div>
           <div class="ms-4">
            <h2>{{announce.title}}</h2>
            <p class="help-text">{{announce.subTitle}}</p>
           </div>
        </div>
      </div>
  <div class="nav-oasis-container d-flex justify-content-between">
    <ul class="nav border-0 h-100">
      <li class="nav-item" role="presentation">
        <a class="nav-link d-flex align-items-center" aria-current="page" :href="'/micro/oasis.html?oasis_id='+oasisId">宣传</a>
      </li>
      <li class="nav-item active" role="presentation">
        <a class="nav-link d-flex align-items-center" aria-current="page" :href="'/micro/oasis/commission.html?oasis_id='+oasisId">委托</a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link d-flex align-items-center" aria-current="page" :href="'/micro/oasis/transparent.html?oasis_id='+oasisId">透视</a>
      </li>
    </ul>
    <div class="toggle-nav me-3 ">
      <div class="d-flex align-items-center h-100 " >
        <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#mcSidebar" aria-controls="bdSidebar" aria-label="Toggle mcSidebar navigation">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="bi" fill="currentColor" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <div class="d-flex justify-content-between oasis-commission-header mt-3">
    <div class="oasis-search d-flex">

      <div class="dropdown">
        <button class="btn commission-filter-btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
          过滤
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" v-preventreclick @click="filterCommissionV('1')">您已接收任务</a></li>
          <li><a class="dropdown-item" v-preventreclick  @click="filterCommissionV('2')">最近7天</a></li>
          <li><a class="dropdown-item" v-preventreclick   @click="filterCommissionV('3')">最近1天</a></li>
        </ul>
      </div>
      <form class="nosubmit" onsubmit="return false">
        <input @keyup.enter.native="retrieveOasisCommissionGridV" v-model="commissionTb_pagination.param.q" class="nosubmit commission-search-btn" type="search" placeholder="搜索...">
      </form>
    </div>
    <button type="button" class="btn btn-primary me-5" data-bs-toggle="modal" data-bs-target="#addTaskModal">
      新任务
    </button>

  </div>
  <div class="mt-2 me-lg-5  commission-tb-container">
    <table class="table table-dark table-hover align-middle mb-0">
      <thead class="help-text">
        <tr>
          <th class="w-md-75 w-lg-75 w-sm-70"></th>
          <th>
            <div class="dropdown">
              <button class="btn commission-tb-filter btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                状态
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" v-preventreclick  @click="retrieveOasisCommissionByTagV('1')">待审核</a></li>
                <li><a class="dropdown-item" v-preventreclick  @click="retrieveOasisCommissionByTagV('6')">派发中</a></li>
                <li><a class="dropdown-item" v-preventreclick  @click="retrieveOasisCommissionByTagV('2')">处理中</a></li>
                <li><a class="dropdown-item" v-preventreclick  @click="retrieveOasisCommissionByTagV('4')">已交付</a></li>
                <li><a class="dropdown-item" v-preventreclick  @click="retrieveOasisCommissionByTagV('5')">已废除</a></li>

              </ul>
            </div>
          </th>
          <th class="text-center">
            <div class="dropdown">
              <button class="btn commission-tb-filter btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                排序
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" v-preventreclick  @click="sortCommissionV('1')">最新发布</a></li>
                <li><a class="dropdown-item" v-preventreclick  @click="sortCommissionV('2')">更早发布</a></li>
              </ul>
            </div>
          </th>
        </tr>
      </thead>
      <tbody class="table-group-divider">
        <tr v-for="record in commissionTb_pagination.records">
          <td class="commission-info">
            <div class="ms-3">
              <a :href="'/micro/arch/commission-ws.html?id=' + record.id" class="url-link">
                <h5>{{record.title}}</h5>
              </a>
              <span class="help-text text-small">佣金: {{record.bonus}}</span>
              <span v-if="!!record.workerName" class="help-text text-small">履行: {{record.workerName}}</span>
              <span class="help-text text-small">在 {{record.addDate}} 由 {{record.founderName}} 创建</span>
            </div>
          </td>
          <td class="commission-tag">
            {{explainOasisCommissionTagV(record.tag)}}
          </td>
          <td class="text-center">
            <button v-if="record.tag=='6' && !isOasisFounder()"  v-preventreclick   @click="receiveCommissionV(record.id)" type="button" 
              data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="接受任务"
              class="btn btn-commission-action ms-3">
              <i class="bi bi-envelope-open"></i>
            </button>
            <button v-if="record.tag=='1' && isOasisFounder()"  v-preventreclick   @click="abortTaskV(record.id)" type="button" 
              data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="否决"
              class="btn btn-commission-action ms-3">
              <i class="bi bi-x-octagon"></i>
            </button>
            <button v-if="record.tag=='1' && isOasisFounder()"  v-preventreclick   @click="addTaskToPoolV(record.id)" type="button" 
              data-bs-custom-class="custom-popover" data-bs-placement="right" data-bs-trigger="hover" data-bs-toggle="popover" data-bs-content="通过"
              class="btn btn-commission-action ms-3">
              <i class="bi bi-patch-check"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <div v-show="isEmptyObjV(commissionTb_pagination.records)" class="empty-content-block">

      没有可用的内容！

    </div>
    <nav v-if="!!commissionTb_pagination.paging" aria-label="Page navigation" class="millstone-pagination">
      <ul class="pagination pagination-lg pagination-dark  border-0">
        <li class="page-item" @click="pagePre(commissionTb_pagination)">
          <a class="page-link"  aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="page-item"  v-for="page in commissionTb_pagination.paging.items" :class="{'current-page-active': commissionTb_pagination.paging.current == page}" 
              @click="pageGo(commissionTb_pagination,page)"><a class="page-link">{{page}}</a></li>
        <li class="page-item" @click="pageNext(commissionTb_pagination)">
          <a class="page-link" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
  
     
     


    </col-content>
    </main>
    
    
    <section class="modals">
    <!-- commission action modal  -->
      <!-- <div class="modal-container">
        <div class="modal fade" id="commissionActionModal" data-bs-backdrop="static" tabindex="-1">
          <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content text-color-dark">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="blueSignModalLabel">任务处理</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="row mb-3">
                  <button type="button" @click="addCommissionV" class="btn btn-option-secondary-micro">完成任务</button>
                </div>
                <div class="row mb-3">
                  <button type="button" @click="addCommissionV" class="btn btn-option-secondary-micro">接受任务</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>  -->
      <!-- new task modal -->
      <div class="modal-container">
        <div class="modal fade" id="addTaskModal" data-bs-backdrop="static" tabindex="-1">
          <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content text-color-dark">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="addTaskModalLabel">新增任务</h1>
                <button @click="closeAddTaskModalHandlerV" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="row mb-3 mt-3">
                  <label for="inputTitle" class="col-sm-4 col-form-label"> 
                    标题 <div class="help-text"> 任务标题(必填,最大80字符) </div>
                  </label>
                  <div class="col-sm-8">
                    <textarea id="inputTitle" v-model="commissionForm.title" class="form-control" maxlength="80" aria-label="With textarea"></textarea>
                  </div>
                </div>
                <div class="row mb-3">
                  <label for="inputBonus" class="col-sm-4 col-form-label"> 
                    佣金 <div class="help-text"> 任务佣金(必填) </div>
                  </label>
                  <div class="col-sm-8">
                    <input type="number" @input="transformInputNumberV($event)" v-model="commissionForm.bonus" min="1" max="50000" step="1"  type="number" class="form-control" id="inputBonus">
                  </div>
                </div>
                <div class="row mb-5">
                  <label for="inputSow" class="col-sm-4 col-form-label"> 
                    摘要 <div class="help-text"> 任务工作范围等内容(必填) </div>
                  </label>
                  <div class="col-sm-8">
                    <textarea type="text" maxlength="4500" rows="13" v-model="commissionForm.sow" class="form-control" id="inputSow">
                    </textarea>
                  </div>
                </div>
               

                <div class="row mb-3 d-flex justify-content-center">
                  <button 
                  :class="{'disabled': !validitateCommissionFormV(), 
                  'btn-primary': validitateCommissionFormV() ,
                  'btn-secondary': !validitateCommissionFormV()  }" 
                   type="button"  v-preventreclick   @click="addCommissionV" class="btn btn-save">提交任务</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </micro-app>
  <section class="feedback_offcanvas" id="section_feedback_offcanvas">

    <div class="offcanvas offcanvas-end" tabindex="-1" id="feedback_offcanvas_right" aria-labelledby="feedbackOffcanvasRightLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="feedbackOffcanvasRightLabel">发送反馈到Bluvarri</h5>
        <button id="closeFeedbackOffcanvas" type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <form id="feedback-form">
          <div class="mt-3">
            <label for="input_issue" class="form-label">您遇到的具体问题是什么(必填,300字以内)</label>
            <textarea  rows="8" type="text" maxlength="300" class="form-control"  id="input_issue"></textarea>
          </div> 
          <div class="mt-3">
            <label class="form-label">附件图片(选填)</label>
            <div class="feedback-attachment-upload-container dropzone-wrapper">
              <img  id="lastestFeedbackAttachment" >
              <div class="dropzone-desc">
                <i class="bi bi-cloud-plus"></i>
              </div>
              <input type="file" id="input_issue_attachment" onchange="previewFeedbackAttachment()" accept="image/jpg, image/png, image/jpeg" class="dropzone">
            </div>
          </div>  
          <div class="mt-3">
            <label for="input_issue_contact" class="form-label">您的联系方式(选填)</label>
            <input id="input_issue_contact"  min="1" max="50000" step="1" type="text" class="form-control" placeholder="请留下邮箱或电话，使我们快速反馈">
          </div> 
          <button type="submit" class="btn btn-primary mt-5 w-100">提交</button>
        </form>
      </div>
    </div>

  </section>
  <script src="/common/javascripts/feedback.js"></script>
  <script type="module" src="/common/javascripts/tm.js"></script>
  <script type="module" src="/micro/javascripts/oasis/commission.js"></script>


</body>
</html>