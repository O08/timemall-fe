<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="robots" content="index,follow">
    <meta http-equiv ='content-language' content ='zh-cn'>


    <link rel="icon" href="https://www.bluvarri.com/favicon.png">
    <title>feedsboard feed page</title>
    <script src="/common/javascripts/avif-webp.min.js"></script>


    <link rel="stylesheet" href="/common/stylesheets/style.scss">
    <link rel="stylesheet" href="/apps/feedsboard/stylesheets/feed.scss">

</head>
<body>
  <micro-app id="app" v-cloak>

    <div v-if="!historyFeed" class="not-found-resource">
      <img src="https://d13-content.oss-cn-hangzhou.aliyuncs.com/common/image/not-found-result.png" alt="bluvarri-service-not-found">
      <h4>未找到内容</h4>
      <p>内容不存在或已被删除</p>
    </div>

    <div v-if="!!historyFeed"  class="app-container" :class="{'sandbox': sandbox=='1' }">
    
      <div class="rich_media_tool_bar">

        <div  class="post-signals">
          <span class="signals-icon"><i class="bi bi-rss"></i></span>
          <span v-show="historyFeed.pin=='1'" class="signals-icon"><i class="bi bi-pin-angle-fill"></i></span>
          <span v-show="historyFeed.highlight=='1'" class="signals-icon"><i class="bi bi-stars highlight"></i></span>
        </div>

      
        <div   class="dropdown-center">
          <button class="btn btn-secondary dropdown-toggle " type="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-three-dots"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-dark">

            <div class="feed-actions">

            
  
              <div class="w-100" v-if="isChannelAdminRoleV() || isFeedAuthorRoleV()">
                <div class="del_post">
                  <button v-preventreclick @click="showDeleteFocusModalV" class="btn-del_post"><i class="bi bi-trash me-1"></i> 删除帖子</button>
                </div>
              </div>
      
              <div  v-if="isFeedAuthorRoleV()" class="author-menu-only">
                <div class="del_post">
                  <button v-preventreclick @click="showEditFeedModalV" class="btn-del_post"><i class="bi bi-pencil me-1"></i> 编辑帖子</button>
                </div>
                <div class="del_post">
                  <button v-preventreclick @click="manageCommentFeatureV"  class="btn-del_post"><i class="bi bi-chat-left-text me-1"></i> {{ historyFeed.commentTag=="0" ? "开放评论区" : "关闭评论区"}} </button>
                </div>
                <div class="del_post">
                  <button :class="{'loading': btn_ctl.material_uploading}" type="button" class="btn-del_post btn-file-upload">
                    <div class="btn-file-upload-wrp"><i class="bi bi-file-arrow-up me-1"></i> 添加附件 <input id="feed_attachment_file" @change="uploadAttachmentV" tabindex="-1" class="file-input" type="file"  multiple=""  style="opacity: 0; cursor: pointer; width: 100%; height: 100%; font-size: 0px; position: absolute; top: 0px; left: 0px;"></div>
                    <div class="loading-content">
                      <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                      <span role="status">正在上传...</span>
                    </div>
                  </button>
                </div>
              </div>
      
              <div v-if="isChannelAdminRoleV()" class="admin-menu-only">
                <div class="del_post">
                  <button v-preventreclick @click="highlightFeedV" class="btn-del_post"><i class="bi bi-stars me-1"></i> {{ historyFeed.highlight=="0" ? "内容加精" : "取消加精"}}</button>
                </div>
                <div class="del_post">
                  <button v-preventreclick @click="pinFeedV" class="btn-del_post"><i class="bi bi-pin-angle me-1"></i> {{ historyFeed.pin=="0" ? "内容置顶" : "取消置顶"}}</button>
                </div>
              </div>

              <div class="commmon-user w-100">
                <div class="del_post">
                  <button v-preventreclick @click="copyPostUrlV" class="btn-del_post"><i class="bi bi-copy me-1"></i> 复制链接</button>
                </div>
                <div class="del_post">
                  <button v-preventreclick @click="refreshPageV"  class="btn-del_post"><i class="bi bi-arrow-clockwise me-1"></i> 刷新</button>
                </div>
              </div>
      
      
            </div>
            
          </ul>
        </div>

  
        

      </div>

      

      <h1 class="rich_media_title">
        {{historyFeed.title}}
      </h1>  

      <div class="rich_media_meta_list">
       
        <a :href="'/'+ historyFeed.authorBrandHandle" target="_blank">
     
          <span class="author">

            <img title="" alt="author avatar" :src="adaptiveImageUriV(historyFeed.authorAvatar) || defaultAvatarImage" @error.once="e => { e.target.src = defaultAvatarImage }"   class="face_radius">
  
            <!-- <div class="autocut"></div> -->
            <em class="autocut">{{historyFeed.author}}</em>
  
          </span>
        </a>
        
        

      </div>  
      <div v-html="historyFeed.richMediaContent" class="rich_media_content">

     
      </div>

      <div class="rich_media_content_detail">
        <span>发布于：{{historyFeed.createAt}}</span>
      </div>

      <div v-show="(!!historyFeed.ctaPrimaryLabel && !!historyFeed.ctaPrimaryUrl) || (!!historyFeed.ctaSecondaryLabel && !!historyFeed.ctaSecondaryUrl)" class="rich_media_cta_container">
        <a  v-if="!!historyFeed.ctaPrimaryLabel && !!historyFeed.ctaPrimaryUrl" class="btn btn-outline-dark btn-open-studio" :href="historyFeed.ctaPrimaryUrl" target="_blank">
          <i class="bi bi-globe me-1"></i>{{historyFeed.ctaPrimaryLabel}}
        </a>
        <a  v-if="!!historyFeed.ctaSecondaryLabel && !!historyFeed.ctaSecondaryUrl" class="btn btn-outline-dark btn-get-starPlan text-white" :href="historyFeed.ctaSecondaryUrl" target="_blank">
          <i class="bi bi-box-arrow-up-right me-1"></i>{{historyFeed.ctaSecondaryLabel}}
        </a>

      </div>

      <div v-if="attachmentsArr.length>0" class="attachments">
        <div v-for="attachmentRow in attachmentsArr" class="attachment-card">
          <div class="attachment-icon">
            <i class="bi bi-file-earmark-ruled"></i>
          </div>
          <div class="attachment-info-wrp">

            <div class="attachment-info">
              <div class="attachment-name">
                {{attachmentRow.fileName}}
              </div>
              <div class="attachment-option">
                <div class="attachment-option__cta download">
                  <a target="_blank" class="download" :download="attachmentRow.fileName" :href="attachmentRow.fileUri"><i class="bi bi-download"></i></a>
                </div>
                <div  v-if="isFeedAuthorRoleV()"  v-preventreclick  @click="deleteAttachmentV(attachmentRow.id)" class="attachment-option__cta trash"><i class="bi bi-trash"></i></div>
  
              </div>
            </div>

          </div>

       
        </div>
      </div>

      <div v-if="historyFeed.commentTag=='1'" class="rich_media_comment_list">
        <div class="comment_list">
          <h2>评论</h2>
          <div class="comment_content">

            <div class="comment_thread" v-if="user_already_login" >
              <a class="user_avatar">
                <img alt="" :src="adaptiveImageUriV(getIdentity().avatar)  || defaultAvatarImage">
              </a>
              <div class="comment_area">
                <div class="inputWrapper w-100">
                  <div class="inputMaxLength">
                    <textarea id="input_comment" @input="autoHeightV($event)" v-model="newFeedComment.content" type="text" value="" placeholder="下面我简单喵两句" maxlength="172" autocorrect="off" class="inputDefault textAreaDefault" >
                    </textarea>
                  </div>
                </div>
                <div class="btn-wrp" :class="{'d-none': newFeedComment.content.trim().length == 0}" >
                  <div class="form-check safeModeInput">
                    <input v-model="newFeedComment.safeMode" class="form-check-input" type="checkbox"  id="safeMode" true-value="1" false-value="0">
                    <label class="form-check-label" for="safeMode">
                      潜行模式
                    </label>
                  </div>
                  <button v-preventreclick  @click="publishNewFeedCommentV" class="btn-tm-primary bgPrimaryBlue">
                    <div class="btn-content">发布</div>
                  </button>
                </div>

              </div>

            </div>

            <div v-for="comment in commentArr" class="comment_thread">
              <a class="user_avatar" :href="'/'+ comment.authorBrandHandle" target="_blank">
                <img alt="brand avatar"  :src="adaptiveImageUriV(comment.authorAvatar) || defaultAvatarImage" @error.once="e => { e.target.src = defaultAvatarImage }">
              </a>
              <div class="comment_message_info">
                <div class="comment_message_head">
                  <div class="user_name">
                    <a  :href="'/'+ comment.authorBrandHandle" target="_blank">{{ comment.safeMode =='0' ? comment.author : "潜行模式"}}</a>
                    <span class="commentCreationTimestamp">{{comment.createAt}}</span></div>
                  <div class="comment_message_menu">
                    <button v-preventreclick @click="deleteFeedCommentV(comment.id)" class="btn-del_comment">
                      <div class="btn-content"><i class="bi bi-trash me-1"></i>删除</div>
                    </button>
                  </div>
                </div>
                <div class="comment_message_contents">
                  {{comment.content}}
                </div>

              </div>

            </div>



          </div>
          <div  class="empty_comment">
            没有更多评论了 
          </div>
        </div>
      </div>
      



    </div>
    
    <section class="modals">
        <!-- focus modal -->
        <div class="modal-container">
          <div class="modal fade" id="focusModal" data-bs-backdrop="static" tabindex="-1">
            <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
              <div class="modal-content">
                <div class="modal-header d-flex justify-content-center border-0 display-dialog-header-bg">
                  <h1 class="modal-title fs-5">操作提示</h1>
                </div>
                <div class="modal-body d-flex justify-content-center border-0 display-dialog-body-bg">
                  <div class="product-feature">
                    <p class="card-text">{{focusModal.message}}</p>
                  </div>
                </div>
                <div class="modal-footer btn-light d-flex justify-content-between border-0 display-dialog-footer-bg">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                  <button v-preventreclick @click="focusModal.confirmHandler"  type="button"  class="btn btn-primary">继续</button>
                </div>
              </div>
            </div>
          </div>
        </div>


        <!-- edit feed Modal -->
      <div class="modal-container">
        <div class="modal fullscreen-modal fade" id="editFeedModal" data-bs-backdrop="static" tabindex="-1">
          <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content text-color-dark">
              
              <div class="modal-body">
                <form onsubmit="return false">

                <input v-model="editFeedObj.title" maxlength="32" class="form-control form-control-lg only-show-bottom mb-3" type="text" placeholder="标题">
 
                <input v-model="editFeedObj.preface" maxlength="38" class="form-control  only-show-bottom preface mb-3" type="text" placeholder="导语" >

                <div class="row g-3 mb-3">
                  <div class="col">

                    <div class="cta-item mb-3">
                      <div class="input-group pb-1">
                        <label for="primary-cta-desc" class="form-label">优选CTA标签(选填):</label>
                        <input v-model="editFeedObj.ctaPrimaryLabel" placeholder="eg. 下载 、订阅" maxlength="6" type="text" class="form-control  cta-input" id="primary-cta-desc" autocomplete="off">
                      </div>
                      <div class="input-group">
                        <label for="primary-cta-link" class="form-label">优选CTA链接(选填):</label>
                        <input v-model="editFeedObj.ctaPrimaryUrl" placeholder="https://yourlink.com" maxlength="588" type="text" class="form-control  cta-input" id="primary-cta-link" autocomplete="off">
                      </div>
                    </div>
                    <div class="cta-item">
                      <div class="input-group pb-1">
                        <label for="secondary-cta-desc" class="form-label">次选CTA标签(选填):</label>
                        <input v-model="editFeedObj.ctaSecondaryLabel" placeholder="eg. 下载 、订阅" maxlength="6" type="text" class="form-control  cta-input" id="secondary-cta-desc" autocomplete="off">
                      </div>

                      <div class="input-group">
                        <label for="secondary-cta-link" class="form-label">次选CTA链接(选填):</label>
                        <input v-model="editFeedObj.ctaSecondaryUrl" maxlength="588" placeholder="https://yourlink.com" type="text" class="form-control  cta-input" id="secondary-cta-link" autocomplete="off">
                      </div>

                    </div>

                  </div>
                  <div class="col feed-cover-col">

                    <div class="feed-cover-container">
                      <div  v-show="!!editFeedObj.coverUrl" class="action-bar-container">
                        <div class="action-bar">
                          <button v-preventreclick @click="reSelectFeedCoverFileV" type="button" class="btn btn-action-bar" data-bs-custom-class="custom-popover" data-bs-placement="top" data-bs-trigger="hover focus" data-bs-toggle="popover" data-bs-content="修改">
                            <i class="bi bi-pencil-fill"></i>
                          </button>
                          <button v-preventreclick @click="removeFeedCoverFileV" type="button" style="color: #fa541c;" class="btn btn-action-bar" data-bs-custom-class="custom-popover" data-bs-placement="top" data-bs-trigger="hover focus" data-bs-toggle="popover" data-bs-content="移除">
                            <i class="bi bi-trash-fill"></i>
                          </button>
                        </div>
                      </div>
                      <div v-show="!editFeedObj.coverUrl" class="uploadInput">
                        <input @change="previewFeedCoverV($event)" id="file_cover" class="file-input" type="file" tabindex="-1" multiple="" accept=".jpg,.jpeg,.png" style="opacity: 0; cursor: pointer; width: 100%; height: 100%; font-size: 0px; position: absolute; top: 0px; left: 0px;">

                        <svg class="uploadIcon" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M2 5a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v8.67c0 .12-.34.17-.39.06A2.87 2.87 0 0 0 19 12a3 3 0 0 0-2.7 1.7c-.1.18-.36.22-.48.06l-.47-.63a2 2 0 0 0-3.2 0L9.93 16.1l-.5-.64a1.5 1.5 0 0 0-2.35 0l-1.86 2.32A.75.75 0 0 0 5.81 19h5.69c.28 0 .5.23.54.5.17.95.81 1.68 1.69 2.11.11.06.06.39-.06.39H5a3 3 0 0 1-3-3V5Zm8.2.98c.23-.91-.88-1.55-1.55-.9a.93.93 0 0 1-1.3 0c-.67-.65-1.78-.01-1.55.9a.93.93 0 0 1-.65 1.12c-.9.26-.9 1.54 0 1.8.48.14.77.63.65 1.12-.23.91.88 1.55 1.55.9a.93.93 0 0 1 1.3 0c.67.65 1.78.01 1.55-.9a.93.93 0 0 1 .65-1.12c.9-.26.9-1.54 0-1.8a.93.93 0 0 1-.65-1.12Z" clip-rule="evenodd" class=""></path><path fill="currentColor" d="M19 14a1 1 0 0 1 1 1v3h3a1 1 0 0 1 0 2h-3v3a1 1 0 0 1-2 0v-3h-3a1 1 0 1 1 0-2h3v-3a1 1 0 0 1 1-1Z" class=""></path></svg>
                      </div>
                      <img v-show="!!editFeedObj.coverUrl" id="cover_file_preview" :src="editFeedObj.coverUrl">
                    </div>

                  </div>

                </div>


                <div id="editor">

                </div>
    

               
                </form>
              </div>

              <div class="modal-footer">

                <button v-preventreclick @click="closeEditFeedModalV" type="button" class="btn-reset">
                  <div class="contents">退出编辑</div>
                </button>

                <button v-preventreclick @click="changeFeedV" type="button" class="btn-save bgPrimaryBlue">保存更改</button>

              </div>




            </div>
          </div>
        </div>
      </div>

    </section>
  </micro-app>

  <script type="module" src="/common/javascripts/tm.js"></script>
  <script type="module" src="/apps/feedsboard/javascripts/feed.js"></script>



</body>
</html>